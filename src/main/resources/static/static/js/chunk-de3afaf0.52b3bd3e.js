(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de3afaf0"],{"0fee":function(e,t,a){},"412d":function(e,t,a){"use strict";a("0fee")},f581:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",staticStyle:{height:"50px"},attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{prop:"indexType"}},[a("el-cascader",{staticStyle:{width:"170px"},attrs:{options:e.indexOptions,size:"small",placeholder:"日志类型"},on:{change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"190px"},attrs:{size:"small",type:"datetime",clearable:!1,placeholder:"选择日期时间"},model:{value:e.dateTime,callback:function(t){e.dateTime=t},expression:"dateTime"}})],1),a("el-form-item",{attrs:{prop:"configType"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.queryParams.timeType,callback:function(t){e.$set(e.queryParams,"timeType",t)},expression:"queryParams.timeType"}},[a("el-radio-button",{attrs:{label:"hour"}},[e._v("近12小时")]),a("el-radio-button",{attrs:{label:"day"}},[e._v("近1天")]),a("el-radio-button",{attrs:{label:"week"}},[e._v("近1周")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1),a("div",{staticClass:"mb8"},[a("el-divider",{staticStyle:{color:"blue"},attrs:{direction:"vertical"}}),a("span",{staticStyle:{"font-family":"微软雅黑","font-size":"small"}},[e._v("异常日志量分布:"),a("font",{staticStyle:{color:"#409EFF"}},[e._v(e._s(this.logType))])],1)],1),a("el-row",{staticStyle:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},[a("e-chart",{attrs:{"chart-data":e.barChartData}})],1),a("div",{staticClass:"mb8"},[a("el-divider",{staticStyle:{color:"blue"},attrs:{direction:"vertical"}}),a("span",{staticStyle:{"font-family":"微软雅黑","font-size":"small"}},[e._v("异常日志明细:"),a("font",{staticStyle:{color:"#409EFF"}},[e._v(e._s(this.logType))])],1)],1),a("el-row",{staticStyle:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.logList,border:!1}},[a("el-table-column",{attrs:{prop:"type",label:"日志类型",width:"180"}}),a("el-table-column",{attrs:{prop:"timeStamp",label:"异常时间",width:"180"}}),a("el-table-column",{attrs:{label:"异常日志内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{innerHTML:e._s(t.row.message)}})]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)],1)],1)},n=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},s=[],o=a("313e"),l=a.n(o),u=a("ed08"),c={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var e=this;this.$_resizeHandler=Object(u["a"])((function(){e.chart&&e.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}};a("817d");var d={mixins:[c],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0}},data:function(){return{chart:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=l.a.init(this.$el,"macarons"),this.setOptions(this.chartData)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.xData,a=e.yData;this.chart.setOption({color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:t,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],series:[{name:"数量",type:"bar",barWidth:"60%",data:a}]})}}},p=d,h=a("2877"),m=Object(h["a"])(p,r,s,!1,null,null,null),f=m.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},y=[];a("a9e3");Math.easeInOutQuad=function(e,t,a,i){return e/=i/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var b=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function v(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function _(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function z(e,t,a){var i=_(),n=e-i,r=20,s=0;t="undefined"===typeof t?500:t;var o=function e(){s+=r;var o=Math.easeInOutQuad(s,i,n,t);v(o),s<t?b(e):a&&"function"===typeof a&&a()};o()}var S={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&z(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&z(0,800)}}},w=S,E=(a("412d"),Object(h["a"])(w,g,y,!1,null,"57ca3983",null)),R=E.exports,x=(a("caad"),a("d3b7"),a("2532"),a("bc3a")),$=a.n(x),T=a("5c96"),P={401:"认证失败，无法访问系统资源",403:"当前操作没有权限",404:"访问资源不存在",default:"系统未知错误，请反馈给管理员"};$.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";var q=$.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API,timeout:6e4});q.interceptors.request.use((function(e){return e}),(function(e){console.log(e),Promise.reject(e)})),q.interceptors.response.use((function(e){var t=e.data.code||200,a=P[t]||e.data.msg||P["default"];if(401!==t)return 500===t?(Object(T["Message"])({message:a,type:"error"}),Promise.reject(new Error(a))):200!==t?(T["Notification"].error({title:a}),Promise.reject("error")):e.data}),(function(e){console.log("err"+e);var t=e.message;return"Network Error"==t?t="后端接口连接异常":t.includes("timeout")?t="系统接口请求超时":t.includes("Request failed with status code")&&(t="系统接口"+t.substr(t.length-3)+"异常"),Object(T["Message"])({message:t,type:"error",duration:5e3}),Promise.reject(e)}));var O=q;function C(e){return O({url:"/logger/list",method:"get",params:e})}function L(e){return O({url:"/logger/eChart",method:"get",params:e})}var k=a("cf45"),D={components:{eChart:f,pagination:R},name:"App",data:function(){return{logList:[],indexOptions:[{value:"host_out_call_index_*",label:"外呼",children:[{value:"DEBUG",label:"DEBUG"},{value:"ERROR",label:"ERROR"},{value:"sql failed",label:"sql failed"}]},{value:"gateway_app_log_*",label:"网关",children:[{value:"创建失败",label:"创建失败"},{value:"ERROR",label:"ERROR"},{value:"sql failed",label:"sql failed"}]},{value:"es_aq_log",label:"安全",children:[{value:"SQL注入",label:"SQL注入"},{value:"ERROR",label:"ERROR"},{value:"sql failed",label:"sql failed"}]}],barChartData:{},loading:!0,showSearch:!0,total:0,dateTime:new Date,queryParams:{pageNum:0,pageSize:10,indexType:"host_out_call_index_*",timeType:"hour",message:""},value:["host_out_call_index_*","DEBUG"],form:{},logType:""}},created:function(){this.getList(),this.getBar()},methods:{getBar:function(){var e=this;L(this.addDateRange(this.queryParams,this.dateTime,this.value)).then((function(t){e.barChartData=t.data,e.changeLogType(e.indexOptions,e.queryParams.indexType)})).catch((function(){}))},getList:function(){var e=this;C(this.addDateRange(this.queryParams,this.dateTime,this.value)).then((function(t){e.logList=t.rows,e.total=t.total,e.loading=!1,e.changeLogType(e.indexOptions,e.queryParams.indexType)})).catch((function(){}))},handleQuery:function(){this.queryParams.pageNum=0,this.getList(),this.getBar()},changeLogType:function(e,t){this.logType=Object(k["b"])(e,t)},handleChange:function(e){}}},N=D,j=Object(h["a"])(N,i,n,!1,null,"e692b96a",null);t["default"]=j.exports}}]);